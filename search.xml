<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Spring Boot自动配置原理</title>
      <link href="/2018/11/28/Spring-Boot%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86/"/>
      <url>/2018/11/28/Spring-Boot%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<center><font size="6px">Spring Boot自动配置原理</font></center><hr><h3 id="Spring-Boot启动类"><a href="#Spring-Boot启动类" class="headerlink" title="Spring Boot启动类"></a>Spring Boot启动类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xushuai.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Spring Boot标准启动类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(DemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Spring Boot启动类的关键:</p><ul><li><code>@SpringBootApplication</code>：Spring Boot应用注解</li><li><code>Main函数</code>：Spring Boot程序入口</li></ul><h3 id="SpringBootApplication"><a href="#SpringBootApplication" class="headerlink" title="@SpringBootApplication"></a>@SpringBootApplication</h3><blockquote><p>查看<code>@SpringBootApplication</code>的源码，可以发现在该注解上还有三个关键的注解<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(ElementType.TYPE)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="meta">@ComponentScan</span>(excludeFilters = &#123;</span><br><span class="line"><span class="meta">@Filter</span>(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),</span><br><span class="line"><span class="meta">@Filter</span>(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) &#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SpringBootApplication &#123;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><ol><li><code>@SpringBootConfiguration</code>：其实该类的作用和<code>@Configuration</code>的作用是一样的，只是为了让语义更加明确，声明这是一个Spring Boot应用的配置类，且该注解一个项目中只能有一个。</li><li><p><code>@EnableAutoConfiguration</code>：开启自动化配置，这是为什么Spring Boot能帮我们自动配置的关键所在，该注解会配合<code>spring-boot-autoconfigure</code>完成自动化配置过程。</p><blockquote><p>官方给出的描述：   第二级的注解@EnableAutoConfiguration，告诉SpringBoot基于你所添加的依赖，去“猜测”你想要如何配置Spring。比如我们引入了spring-boot-starter-web，而这个启动器中帮我们添加了tomcat、SpringMVC的依赖。此时自动配置就知道你是要开发一个web应用，所以就帮你完成了web及SpringMVC的默认配置了！</p></blockquote></li><li><p><code>@ComponentScan</code>：Spring的包扫描，该注解如果不声明<code>basePackages</code>会以声明该注解的类的路径为基础包扫描路径。</p></li></ol><h3 id="Spring-Boot-Main函数入口"><a href="#Spring-Boot-Main函数入口" class="headerlink" title="Spring Boot Main函数入口"></a>Spring Boot Main函数入口</h3><blockquote><p>查看源码，在执行run方法的过程中，会对Spring容器进行初始化，这个初始化会加载当前项目所有的bean对象，包括引入的jar包中的bean对象（实质是加载<code>spring.factories</code>文件中声明的所有类到spring容器）。<br><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxo5vv9r4bj30gq05xwet.jpg" alt=""></p></blockquote><ol><li><p>Spring Boot会加载依赖中的<code>spring-boot-autoconfigure</code>，该依赖中进行了大量的默认配置，包括很多主流的开源框架（这里不一一举例，可以点开源码进行查看）<br><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxo4k4veg9j30h905nwex.jpg" alt=""></p></li><li><p><code>spring-boot-autoconfigure</code>是怎么完成自动配置的？在该项目中，我们会发现有很多<code>AutoConfiguration</code> 类，所有的默认配置都是在这些类中完成的，在这些类上你会发现都有一些以<code>Conditional</code>开头的注解，这些注解就是用来控制当前类中的配置是否生效的注解 （以<code>RedisRepositoriesAutoConfiguration</code>为例）。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(EnableRedisRepositories.class)</span><br><span class="line"><span class="meta">@ConditionalOnBean</span>(RedisConnectionFactory.class)</span><br><span class="line"><span class="meta">@ConditionalOnProperty</span>(prefix = <span class="string">"spring.data.redis.repositories"</span>, name = <span class="string">"enabled"</span>, havingValue = <span class="string">"true"</span>, matchIfMissing = <span class="keyword">true</span>)</span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span>(RedisRepositoryFactoryBean.class)</span><br><span class="line"><span class="meta">@Import</span>(RedisRepositoriesAutoConfigureRegistrar.class)</span><br><span class="line"><span class="meta">@AutoConfigureAfter</span>(RedisAutoConfiguration.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisRepositoriesAutoConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>Conditional</code>相关注解<br>3.1 <code>ConditionalOnClass</code>：此项目下存在参数列表中的类时，则自动配置生效。<br>3.2 <code>ConditionalOnBean</code>：此项目下存在参数列表中的Bean时，则自动配置生效。<br>3.3 <code>ConditionalOnProperty</code>：此项目下存在参数列表中的配置文件时，则自动配置生效（该注解还可以进一步定制，具体可以自行查看该配置的源码）。<br>3.4 <code>ConditionalOnMissingBean</code>：此项目中没有参数列表中的Bean，则自动配置生效（防止重复配置）。</p></li><li><p>默认配置覆盖，主要有两种方法<br>4.1 自定义相同类型的<code>Bean</code>覆盖掉默认配置中的<code>Bean</code>。<br>4.2 在application.yaml中覆盖掉指定<code>Bean</code>的属性(可以在<code>spring-boot-autoconfigure</code>中找到想要覆盖的属性的key，然后在自己的项目重新声明该key的值就可以了)。</p></li></ol><blockquote><p>Spring Boot自动配置原理就大致如此，更多细节请阅读Spring Boot源码和官方文档。<br><a href="https://spring.io/projects/spring-boot" target="_blank" rel="noopener">Spring Boot官网</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Spring Boot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>配置Nginx反向代理</title>
      <link href="/2018/11/27/%E9%85%8D%E7%BD%AENginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"/>
      <url>/2018/11/27/%E9%85%8D%E7%BD%AENginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<center><font size="6px">配置Nginx反向代理</font></center><hr><h3 id="反向代理介绍"><a href="#反向代理介绍" class="headerlink" title="反向代理介绍"></a>反向代理介绍</h3><ol><li>反向代理（Reverse Proxy）方式是指以代理服务器来接受internet上的连接请求，然后将请求转发给内部网络上的服务器，并将从服务器上得到的结果返回给internet上请求连接的客户端，此时代理服务器对外就表现为一个反向代理服务器。</li></ol><ol start="2"><li>反向代理的作用：</li></ol><blockquote><p>（1）保证内网的安全，可以使用反向代理提供WAF功能，阻止web攻击大型网站，通常将反向代理作为公网访问地址，Web服务器是内网。<br>（2）负载均衡，通过反向代理服务器来优化网站的负载。</p></blockquote><h3 id="反向代理Demo"><a href="#反向代理Demo" class="headerlink" title="反向代理Demo"></a>反向代理Demo</h3><blockquote><p>系统：centos 7<br>此处使用tomcat作为被代理的服务器</p></blockquote><ol><li>准备工作<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- centos 7安装jdk</span><br><span class="line">- 上传tomcat到服务器（解压出两份，注意修改解压出来的目录名称）</span><br><span class="line">- 安装nginx</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmsanbicij3149091wft.jpg" alt=""></p><ol start="2"><li><p>修改tomcat配置，防止端口冲突（文件位置：<code>tomcat/conf/server.xml</code>）,只需要修改其中一个tomcat配置即可<br><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmsanr9wgj30mf02dt8t.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmsanml21j30my02daa8.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmsanioycj30n701zweo.jpg" alt=""></p></li><li><p>修改ngxin配置(文件位置:<code>nginx/conf/nginx.conf</code>)</p></li></ol><ul><li><p>第一种配置方式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">upstream tomcat-test1 &#123;</span><br><span class="line">    ## 设置被代理的ip</span><br><span class="line">server 192.168.200.132:8080;</span><br><span class="line">   &#125;</span><br><span class="line">   server &#123;</span><br><span class="line">       listen       80;</span><br><span class="line">       server_name  www.tomcat1.com;</span><br><span class="line"></span><br><span class="line">       #charset koi8-r;</span><br><span class="line"></span><br><span class="line">       #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">       location / &#123;</span><br><span class="line">           ## 被代理路径</span><br><span class="line">           proxy_pass   http://192.168.200.132:8080;</span><br><span class="line">           index  index.html index.htm;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">upstream tomcat-test2 &#123;</span><br><span class="line">server 192.168.200.132:8081;</span><br><span class="line">   &#125;</span><br><span class="line">   server &#123;</span><br><span class="line">       listen       80;</span><br><span class="line">       server_name  www.tomcat2.com;</span><br><span class="line"></span><br><span class="line">       #charset koi8-r;</span><br><span class="line"></span><br><span class="line">       #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">       location / &#123;</span><br><span class="line">           proxy_pass   http://192.168.200.132:8081;</span><br><span class="line">           index  index.html index.htm;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li><li><p>第二种配置方式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">upstream tomcat-test1 &#123;</span><br><span class="line">    ## 设置被代理的ip</span><br><span class="line">server 192.168.200.132:8080;</span><br><span class="line">   &#125;</span><br><span class="line">   server &#123;</span><br><span class="line">       listen       80;</span><br><span class="line">       server_name  www.tomcat1.com;</span><br><span class="line"></span><br><span class="line">       #charset koi8-r;</span><br><span class="line"></span><br><span class="line">       #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">       location / &#123;</span><br><span class="line">           ## 被代理路径</span><br><span class="line">           proxy_pass   http://tomcat-test1;</span><br><span class="line">           index  index.html index.htm;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">upstream tomcat-test2 &#123;</span><br><span class="line">server 192.168.200.132:8081;</span><br><span class="line">   &#125;</span><br><span class="line">   server &#123;</span><br><span class="line">       listen       80;</span><br><span class="line">       server_name  www.tomcat2.com;</span><br><span class="line"></span><br><span class="line">       #charset koi8-r;</span><br><span class="line"></span><br><span class="line">       #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">       location / &#123;</span><br><span class="line">           proxy_pass   http://tomcat-test2;</span><br><span class="line">           index  index.html index.htm;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li></ul><ol start="4"><li><p>运行tomcat，运行nginx</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># tomcat </span><br><span class="line">tomcat-test1/bin/startup.sh</span><br><span class="line">tomcat-test2/bin/startup.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span># nginx</span><br><span class="line">nginx/sbin/nginx</span><br></pre></td></tr></table></figure></li><li><p>测试<br><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmsaog8yej30zc0b6gnx.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmsao9ogij312409w40s.jpg" alt=""></p></li></ol><h3 id="配置均衡负载"><a href="#配置均衡负载" class="headerlink" title="配置均衡负载"></a>配置均衡负载</h3><ol><li>配置<code>nginx.conf</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">   ## 轮询,每个节点一次</span><br><span class="line">upstream tomcat-test2 &#123;</span><br><span class="line">server 192.168.200.132:8081;</span><br><span class="line">server 192.168.200.132:8082;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   ## 设置权重</span><br><span class="line">   upstream tomcat-test2 &#123;</span><br><span class="line">server 192.168.200.132:8081;</span><br><span class="line">server 192.168.200.132:8082 weight=2; //权重越大，分配到的请求越多</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="反向代理实例"><a href="#反向代理实例" class="headerlink" title="反向代理实例"></a>反向代理实例</h3><ol><li><p>配置<code>nginx.conf</code>文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">  # erp项目</span><br><span class="line">  upstream erp &#123;</span><br><span class="line">server 192.168.183.130:8080;</span><br><span class="line">  &#125;</span><br><span class="line">  server &#123;</span><br><span class="line">      listen       80;</span><br><span class="line">      server_name  192.168.183.130:8080;</span><br><span class="line">      ## 代理相关静态资源</span><br><span class="line">      location / &#123;</span><br><span class="line">          proxy_pass   http://192.168.183.130:8080;</span><br><span class="line">proxy_read_timeout 600s;</span><br><span class="line">proxy_set_header  X-Real-IP  $remote_addr;</span><br><span class="line">proxy_set_header Host $host:$server_port;</span><br><span class="line">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">       </span><br><span class="line">          index  index.html index.htm;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">      error_page   500 502 503 504  /50x.html;</span><br><span class="line">      location = /50x.html &#123;</span><br><span class="line">          root   html;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>测试<br><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmt2zfz7nj31340hhq4e.jpg" alt=""></p><blockquote><p>使用域名能访问到是因为我配置了hosts IP映射，如果没有配置，请使用IP访问</p></blockquote></li></ol>]]></content>
      
      
      <categories>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ngxin,反向代理 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Ngxin安装</title>
      <link href="/2018/11/27/Ngxin%E5%AE%89%E8%A3%85/"/>
      <url>/2018/11/27/Ngxin%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<center><font size="6px">Nginx安装</font></center><hr><h3 id="Nginx介绍"><a href="#Nginx介绍" class="headerlink" title="Nginx介绍"></a>Nginx介绍</h3><p>Nginx是一款轻量级的Web 服务器/反向代理服务器及电子邮件（IMAP/POP3）代理服务器，并在一个BSD-like 协议下发行。其特点是占有内存少，并发能力强，事实上nginx的并发能力确实在同类型的网页服务器中表现较好，中国大陆使用nginx网站用户有：百度、京东、新浪、网易、腾讯、淘宝等。   </p><p><a href="https://nginx.org/" target="_blank" rel="noopener">Nginx官网</a></p><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><blockquote><p>系统：centos 7</p></blockquote><ol><li>下载nginx压缩包并上传至centos系统</li><li>安装nginx需要的第三方库<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># PCRE：PCRE(Perl Compatible Regular Expressions)是一个Perl库，包括 perl 兼容的正则表达式库。nginx的http模块使用pcre来解析正则表达式，所以需要在linux上安装pcre库。</span><br><span class="line">yum install -y pcre pcre-devel</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span># zlib：zlib库提供了很多种压缩和解压缩的方式，nginx使用zlib对http包的内容进行gzip，所以需要在linux上安装zlib库。</span><br><span class="line">yum install -y zlib zlib-devel</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span># openssl：OpenSSL 是一个强大的安全套接字层密码库，囊括主要的密码算法、常用的密钥和证书封装管理功能及SSL协议，并提供丰富的应用程序供测试或其它目的使用。</span><br><span class="line">yum install -y openssl openssl-devel</span><br></pre></td></tr></table></figure></li></ol><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ol><li><p>解压nginx压缩包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># 该压缩包路径为当前目录</span><br><span class="line">tar -zxvf nginx-1.8.0.tar.gz</span><br></pre></td></tr></table></figure></li><li><p>使用nginx主目录中的configure命令生成makefile文件（将下面的命令一次性全部复制并执行）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># 进入nginx目录(版本号以你下载的版本号为准，请注意修改)</span><br><span class="line">cd nginx-1.8.0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span># 创建nginx临时目录</span><br><span class="line">mkdir -p /var/temp/nginx</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span># 复制下方全部，执行</span><br><span class="line">./configure \</span><br><span class="line">--prefix=/usr/local/nginx \</span><br><span class="line">--pid-path=/var/run/nginx/nginx.pid \</span><br><span class="line">--lock-path=/var/lock/nginx.lock \</span><br><span class="line">--error-log-path=/var/log/nginx/error.log \</span><br><span class="line">--http-log-path=/var/log/nginx/access.log \</span><br><span class="line">--with-http_gzip_static_module \</span><br><span class="line">--http-client-body-temp-path=/var/temp/nginx/client \</span><br><span class="line">--http-proxy-temp-path=/var/temp/nginx/proxy \</span><br><span class="line">--http-fastcgi-temp-path=/var/temp/nginx/fastcgi \</span><br><span class="line">--http-uwsgi-temp-path=/var/temp/nginx/uwsgi \</span><br><span class="line">--http-scgi-temp-path=/var/temp/nginx/scgi</span><br></pre></td></tr></table></figure></li><li><p>执行生成的Makefile文件<br><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmray6fy8j30q402nglr.jpg" alt=""></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># 编译Makefile文件</span><br><span class="line">make</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span># 执行安装</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></li><li><p>进入<code>/usr/local/</code>查看是否安装成功</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmrbpo0pmj30um02gdfw.jpg" alt=""></p><ol start="5"><li><p>启动 nginx</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># 启动nginx（当前目录为：/usr/local）</span><br><span class="line">nginx/sbin/nginx</span><br></pre></td></tr></table></figure></li><li><p>查看是否成功启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux|grep nginx</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmrbpwbgcj311d034dg4.jpg" alt=""></p><ol start="7"><li>访问nginx服务器<br><img src="https://ws1.sinaimg.cn/large/006ifTg0gy1fxmrbq1202j30wo0dqaas.jpg" alt=""></li></ol><blockquote><p>其他命令   </p></blockquote><ul><li>停止命令:  </li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># 两个命令都可以完成停止操作</span><br><span class="line">./nginx -s stop   </span><br><span class="line">./nginx -s quit   //建议使用这个命令</span><br></pre></td></tr></table></figure><ul><li>重启</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./nginx -s reload</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx,服务器代理 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>使用hexo搭建个人博客</title>
      <link href="/2018/11/25/%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
      <url>/2018/11/25/%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<center><font size="6px">Hexo搭建个人博客</font></center><hr><h3 id="Hexo介绍"><a href="#Hexo介绍" class="headerlink" title="Hexo介绍"></a>Hexo介绍</h3><p>hexo是一款基于Node.js的静态博客框架。   </p><p><a href="https://hexo.io/zh-cn/index.html" target="_blank" rel="noopener">hexo中文网</a></p><h3 id="搭建Hexo博客环境"><a href="#搭建Hexo博客环境" class="headerlink" title="搭建Hexo博客环境"></a>搭建Hexo博客环境</h3><blockquote><p>系统：centos 7   </p></blockquote><ol><li>安装 Hexo 需要的环境<br>由于Hexo是基于<code>Node.js</code>的，所以NodeJS环境肯定是必须的。</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install nodejs -y</span><br></pre></td></tr></table></figure><p>也可以参考：<a href="http://www.runoob.com/nodejs/nodejs-install-setup.html" target="_blank" rel="noopener">node.js安装教程</a></p><ol start="2"><li><p>安装 git</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install git -y</span><br><span class="line"><span class="meta">#</span> 设置github的账户信息</span><br><span class="line">git config --global user.email "你的github邮箱"</span><br><span class="line">git config --global user.name  "自定义名称"</span><br></pre></td></tr></table></figure></li><li><p>创建github仓库</p><blockquote><p>我这里采用github作为博客文章的仓库，如果还没有github，请自行注册并创建仓库。</p></blockquote></li></ol><p>仓库名称为<code>custom.github.io</code>，其中<code>custom</code>为自定义部分，如：<code>mayun.github.io</code></p><ol start="4"><li><p>安装 Hexo</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure></li><li><p>初始化 Hexo</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># custom以你创建的仓库名为准</span><br><span class="line">hexo init custom.github.io</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>此时在当前目录会出现<code>custom.github.io</code>文件夹</p></blockquote><h3 id="配置-Hexo"><a href="#配置-Hexo" class="headerlink" title="配置 Hexo"></a>配置 Hexo</h3><ol><li>更换一个好看的主题<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># 进入customer.github.io文件夹</span><br><span class="line">cd custom.github.io</span><br><span class="line"><span class="meta">#</span># 使用git下载一款喜欢的主题,我这里下载的是 next 主题</span><br><span class="line">git clone https://github.com/iissnan/hexo-theme-next.git themes/next</span><br></pre></td></tr></table></figure></li></ol><p><a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">附: next主题github</a></p><ol start="2"><li>博客配置<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># 修改custom.github.io中的_config.yml文件</span><br><span class="line">vim _config.yml</span><br></pre></td></tr></table></figure></li></ol><blockquote><h5 id="主要需要修改的配置："><a href="#主要需要修改的配置：" class="headerlink" title="主要需要修改的配置："></a>主要需要修改的配置：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">title: title #网站名称   </span><br><span class="line">Subtitle: Subtitle #二级标题   </span><br><span class="line">description: description #网页描述   </span><br><span class="line">author: author #作者   </span><br><span class="line">language: zh-Hans #不同的主题，这里的值可能不一样   </span><br><span class="line">timezone: Asia/Shanghai #时区   </span><br><span class="line">url: http://xxxxx  #可以是ip或域名 </span><br><span class="line">theme: next #修改主题   </span><br><span class="line">port: 4000 #若没有，可自行添加该配置项</span><br><span class="line">server_ip: localhost #若没有，可自行添加该配置项</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https://github.com/xs1031893936/xushuai.github.io.git #你的github仓库地址</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure></blockquote><p><a href="https://hexo.io/zh-cn/docs/configuration.html" target="_blank" rel="noopener">其他配置项参考</a></p><blockquote><p><strong>注意的坑</strong>：   配置文件为yml格式, 所以每个配置项 <code>:</code>必须有一个空格,配置文件中还有很多地方配置的值为<code>:year</code>这种形式,此<code>:</code>后不能有空格</p></blockquote><ol start="3"><li><p>编写测试博客</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># 进入`customer.github.io/source/_post/`目录中新建文件</span><br><span class="line">touch test-blog.md</span><br><span class="line"><span class="meta">#</span># 编辑，若没有vim，使用vi编辑器</span><br><span class="line">vim test-blog.md</span><br><span class="line"><span class="meta">#</span># 内容---------------------------------</span><br><span class="line">---</span><br><span class="line">title: test-blog</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> hello hexo!</span><br><span class="line"><span class="meta">#</span># 内容---------------------------------</span><br></pre></td></tr></table></figure></li><li><p>运行hexo</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>若未正常运行，注意查看报错</p></blockquote><ol start="5"><li><p>访问博客</p></li><li><p>安装自动部署发布工具</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></li><li><p>发布到github</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>提交需要输入github账号和密码</p></blockquote><p>基本上hexo博客的搭建已经完成。</p><p><a href="https://juejin.im/entry/59d2da336fb9a00a5015e16b" target="_blank" rel="noopener">附:hexo主题自定义</a></p>]]></content>
      
      
      <categories>
          
          <category> 其他 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo,blog,个人博客 </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
